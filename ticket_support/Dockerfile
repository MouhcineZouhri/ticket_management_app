FROM eclipse-temurin:21

WORKDIR /app

COPY .mvn/ .mvn
COPY mvnw pom.xml ./
RUN ./mvnw dependency:go-offline

COPY src ./src

ENV DATASOURCE_URL=${DATASOURCE_URL}
ENV DATASOURCE_DRIVER_CLASS_NAME=${DATASOURCE_DRIVER_CLASS_NAME}
ENV DATASOURCE_USERNAME=${DATASOURCE_USERNAME}
ENV DATASOURCE_PASSWORD=${DATASOURCE_PASSWORD}
ENV SERVER_PORT=${SERVER_PORT:-8080}

EXPOSE ${SERVER_PORT:-8080}

CMD ["./mvnw", "spring-boot:run"]